(version 0)
(section 'filter'
  (default 'code'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (eval 'code.function')
        (append)
      )
    )
  )
  (default 'code.address'
    (seq
      (append (varuint32 6))
      (append (varuint32 6))
    )
  )
  (default 'code.br_table'
    (seq
      (append (uint32 1))
      (loop (append (varuint32 6))
        (append (varuint32 6))
      )
      (append (varuint32 6))
    )
  )
  (default 'code.br_target'
    (seq
      (append (uint32 1))
      (append (varuint32 6))
    )
  )
  (default 'code.call_args'
    (seq
      (append (uint32 1))
      (append (varuint32 6))
    )
  )
  (default 'code.function'
    (seq
      (preorder 0)
      (block (varuint32) 0xff)
      (loop (append (varuint32 6))
        (eval 'code.locals')
      )
      (loop.unbounded
        (eval 'code.inst')
        (append)
      )
    )
  )
  (default 'code.locals'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (uint32 3))
      )
    )
  )
  (default 'code.inst'
    (seq
      (preorder 0)
      (select (append (uint8))
        (void)
        (case 0x6 (eval 'code.br_target'))
        (case 0x7 (eval 'code.br_target'))
        (case 0x8 (eval 'code.br_table'))
        (case 0x9 (append (uint32 1)))
        (case 0x10 (append (varint32 6)))
        (case 0x11 (append (varint64 6)))
        (case 0x12 (append (uint64)))
        (case 0x13 (append (uint32)))
        (case 0x14 (append (varuint32 6)))
        (case 0x15 (append (varuint32 6)))
        (case 0x16 (eval 'code.call_args'))
        (case 0x17 (eval 'code.call_args'))
        (case 0x18 (eval 'code.call_args'))
        (case 0x20 (eval 'code.address'))
        (case 0x21 (eval 'code.address'))
        (case 0x22 (eval 'code.address'))
        (case 0x23 (eval 'code.address'))
        (case 0x24 (eval 'code.address'))
        (case 0x25 (eval 'code.address'))
        (case 0x26 (eval 'code.address'))
        (case 0x27 (eval 'code.address'))
        (case 0x28 (eval 'code.address'))
        (case 0x29 (eval 'code.address'))
        (case 0x2a (eval 'code.address'))
        (case 0x2b (eval 'code.address'))
        (case 0x2c (eval 'code.address'))
        (case 0x2d (eval 'code.address'))
        (case 0x2e (eval 'code.address'))
        (case 0x2f (eval 'code.address'))
        (case 0x30 (eval 'code.address'))
        (case 0x31 (eval 'code.address'))
        (case 0x32 (eval 'code.address'))
        (case 0x33 (eval 'code.address'))
        (case 0x34 (eval 'code.address'))
        (case 0x35 (eval 'code.address'))
        (case 0x36 (eval 'code.address'))
        (case 0xff (block.end))
      )
    )
  )
  (default 'data'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (eval 'data_segment')
        (append)
      )
    )
  )
  (default 'data.segment'
    (seq
      (preorder 0)
      (append (varuint32 6))
      (loop (append (varuint32 6))
        (append (uint8))
      )
    )
  )
  (default 'export'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (eval 'export.entry')
      )
    )
  )
  (default 'export.entry'
    (seq
      (preorder 0)
      (append (varuint32 6))
      (eval 'export.symbol')
      (append)
    )
  )
  (default 'export.symbol'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (uint8))
      )
    )
  )
  (default 'function'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (varuint32 6))
      )
    )
  )
  (default 'import'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (eval 'import_entry')
      )
    )
  )
  (default 'import.entry'
    (seq
      (preorder 0)
      (append (varuint32 6))
      (eval 'import.symbol')
      (append)
      (eval 'import.symbol')
      (append)
    )
  )
  (default 'import.symbol'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (uint8))
      )
    )
  )
  (default 'memory'
    (seq
      (varuint32 6)
      (varuint32 6)
      (uint32 1)
      (preorder 3)
    )
  )
  (default 'name'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (eval 'function_names')
        (append)
      )
    )
  )
  (default 'name.function'
    (seq
      (preorder 0)
      (eval 'name.symbol')
      (append)
      (loop (append (varuint32 6))
        (eval 'name.symbol')
        (append)
      )
    )
  )
  (default 'name.symbol'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (uint8))
      )
    )
  )
  (default 'start'
    (varuint32 6)
  )
  (default 'table'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (varuint32 6))
      )
    )
  )
  (default 'type'
    (seq
      (preorder 0)
      (loop (append (varuint32 6))
        (append (varuint7))
        (loop (append (varuint32 6))
          (eval 'type.value_type')
        )
        (eval 'type.return_type')
      )
    )
  )
  (default 'type.return_type'
    (if (append (uint32 1))
      (eval 'value_type')
      (void)
    )
  )
  (default 'type.value_type'
    (append (uint32 3))
  )
)
